<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate mixed-layer depth from temperature profiles — calc_hmix • LakeEnsemblR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate mixed-layer depth from temperature profiles — calc_hmix"><meta name="description" content="This function estimates the mixed depth. It finds the minimum curvature
in the profile (maximum for winter stratification) as the border of the surface mixed
layer. Then it finds the thermocline as the depth of maximum T-gradient. It
estimates the mixed layer depth as the depth where the regression line through
the surface layer temperatures intersects with the regression line through the
thermocline temperatures. It performs some other checks, like whether
stratification exists (Ts-Tb) &amp;gt; threshold min.dT, and whether the thermocline
is above the surface layer, or whether the lake is completely isothermal and
there is no intersection (and returns NA). If mixed, it assumes the mixed
layer depth is the maximum depth. It also plots the profile if desired
(plot=TRUE), marking the surface layer and inflection point in red and the
thermocline in blue."><meta property="og:description" content="This function estimates the mixed depth. It finds the minimum curvature
in the profile (maximum for winter stratification) as the border of the surface mixed
layer. Then it finds the thermocline as the depth of maximum T-gradient. It
estimates the mixed layer depth as the depth where the regression line through
the surface layer temperatures intersects with the regression line through the
thermocline temperatures. It performs some other checks, like whether
stratification exists (Ts-Tb) &amp;gt; threshold min.dT, and whether the thermocline
is above the surface layer, or whether the lake is completely isothermal and
there is no intersection (and returns NA). If mixed, it assumes the mixed
layer depth is the maximum depth. It also plots the profile if desired
(plot=TRUE), marking the surface layer and inflection point in red and the
thermocline in blue."><meta property="og:image" content="https://aemon-j.github.io/LakeEnsemblR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LakeEnsemblR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Get started</h6></li>
    <li><a class="dropdown-item" href="../articles/lakeensemblr-overview.html">LakeEnsemblR: Basic Use and Sample Applications</a></li>
    <li><a class="dropdown-item" href="../articles/setting-up-lakeensemblr.html">Setting up LakeEnsemblR</a></li>
    <li><a class="dropdown-item" href="../articles/running-lakeensemblr.html">Running LakeEnsemblR</a></li>
    <li><a class="dropdown-item" href="../articles/running-lakeensemblr-in-parallel.html">Running LakeEnsemblR in parallel</a></li>
    <li><a class="dropdown-item" href="../articles/post-processing-lakeensemblr.html">Post-processing LakeEnsemblR</a></li>
    <li><a class="dropdown-item" href="../articles/calibrating-lakeensemblr.html">Calibrating LakeEnsemblR</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Installation</h6></li>
    <li><a class="dropdown-item" href="../articles/docker.html">Docker</a></li>
    <li><a class="dropdown-item" href="../articles/installation-issues.html">Installation issues</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/what-is-a-netcdf-file.html">What is a NetCDF file</a></li>
    <li><a class="dropdown-item" href="../articles/lake-models.html">Lake Models</a></li>
    <li><a class="dropdown-item" href="../articles/package-structure.html">Package structure</a></li>
    <li><a class="dropdown-item" href="../articles/from-v1-0-to-v1-1-changes.html">From v1.0 to v1.1 changes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aemon-j/LakeEnsemblR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate mixed-layer depth from temperature profiles</h1>
      <small class="dont-index">Source: <a href="https://github.com/aemon-j/LakeEnsemblR/blob/main/R/calc_hmix.R" class="external-link"><code>R/calc_hmix.R</code></a></small>
      <div class="d-none name"><code>calc_hmix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates the mixed depth. It finds the minimum curvature
in the profile (maximum for winter stratification) as the border of the surface mixed
layer. Then it finds the thermocline as the depth of maximum T-gradient. It
estimates the mixed layer depth as the depth where the regression line through
the surface layer temperatures intersects with the regression line through the
thermocline temperatures. It performs some other checks, like whether
stratification exists (Ts-Tb) &gt; threshold min.dT, and whether the thermocline
is above the surface layer, or whether the lake is completely isothermal and
there is no intersection (and returns NA). If mixed, it assumes the mixed
layer depth is the maximum depth. It also plots the profile if desired
(plot=TRUE), marking the surface layer and inflection point in red and the
thermocline in blue.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_hmix</span><span class="op">(</span></span>
<span>  <span class="va">temps</span>,</span>
<span>  <span class="va">depths</span>,</span>
<span>  min.dT <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  therm.dz <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min.hmix <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-temps">temps<a class="anchor" aria-label="anchor" href="#arg-temps"></a></dt>
<dd><p>a numeric vector of water temperature in degC.</p></dd>


<dt id="arg-depths">depths<a class="anchor" aria-label="anchor" href="#arg-depths"></a></dt>
<dd><p>a numeric vector corresponding to the depths (in m) of the temps
measurements</p></dd>


<dt id="arg-min-dt">min.dT<a class="anchor" aria-label="anchor" href="#arg-min-dt"></a></dt>
<dd><p>numeric; minimum change in water temperature</p></dd>


<dt id="arg-therm-dz">therm.dz<a class="anchor" aria-label="anchor" href="#arg-therm-dz"></a></dt>
<dd><p>numeric; depth resolution for calculating thermoclime</p></dd>


<dt id="arg-min-hmix">min.hmix<a class="anchor" aria-label="anchor" href="#arg-min-hmix"></a></dt>
<dd><p>numeric; minimum depth of hmix otherwise returns NA. Defaults to 1.5m</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>boolean; plot temperature profile with calculated mixed depth.
Defaults to FALSE</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments to be passed to base plot</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tom Shatwell</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tadhg Moore, Robert Ladwig, Johannes Feldbauer, Jorrit Mesman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

